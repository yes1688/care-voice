# 簡化版 Care Voice 統一容器
FROM docker.io/library/nginx:alpine

# 安裝必要工具
RUN apk add --no-cache curl bash

# 複製前端文件
COPY frontend/dist/ /usr/share/nginx/html/

# 複製 nginx 配置
COPY nginx-production.conf /etc/nginx/conf.d/default.conf

# 暴露端口
EXPOSE 8000

# 健康檢查
HEALTHCHECK --interval=30s --timeout=10s --start-period=10s --retries=3 \
    CMD curl -f http://localhost:8000/ || exit 1

# 啟動 nginx
CMD ["nginx", "-g", "daemon off;"]